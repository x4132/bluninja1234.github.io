import React from "react";
import { Link, Route, Routes } from "react-router-dom";

export default function WebExploits() {

    return <Routes>
        <Route path={"*"} element={<Index />} />
    </Routes>
}


function Index() {
    return <div className="d-flex flex-column align-items-center pt-2" >
        <div className="d-flex align-items-center" >
            <h1>Writeups&nbsp;/&nbsp;</h1><h2>picoCTF&nbsp;/&nbsp;</h2><h3>2022&nbsp;/&nbsp;</h3><h4>Web Exploitation</h4>
        </div>

        <Challenge title="Includes" >
            <code>
                Can you get the flag?<br />
                Go to this <a href="http://saturn.picoctf.net:57833/" >website</a> and see what you can discover.
            </code>
            <p className="mt-2">
                Visit the website, inspect the source, and get the flag from the external .css and .js file.
            </p>
            <div>
                Flag:
                <code>{"picoCTF{1nclu51v17y_1of2_f7w_2of2_(hash)}"}</code>
            </div>
        </Challenge>

        <Challenge title="Inspect HTML">
            <code>
                Can you get the flag?<br />
                Go to this <a href="http://saturn.picoctf.net:59126/">website</a> and see what you can discover.
            </code>
            <p className="mt-2">
                Inspect the HTML, flag is in a comment.
            </p>
            <div>
                Flag: <code>{"picoCTF{1n5p3t0r_0f_h7ml_(hash)}"}</code>
            </div>
        </Challenge>

        <Challenge title="Local Authority" >
            <code>
                Can you get the flag?
                Go to this website and see what you can discover.
            </code>
            <p className="mt-2" >
                <ol>
                    <li>No javascript files in /</li>
                    <li>Attempt to login with random data, get sent to /login.php</li>
                    <li>Inspect /login.php, find /secure.js</li>
                    <li>/secure.js contains username and password for admin (admin@strongPassword098765)</li>
                    <li>Login with password, get flag</li>
                </ol>
            </p>
            <div>
                Flag: <code>{"picoCTF{j5_15_7r4n5p4r3n7_(hash)}"}</code>
            </div>
        </Challenge>

        <Challenge title="Search source">
            <code>
                The developer of this website mistakenly left an important artifact in the website source, can you find it?<br />
                The website is here(link to website)
            </code>
            <p className="mt-2 text-center" >
                Chrome lets you view the source with CTRL-U. We can use CTRL-F to search for code.<br />
                However, we don't find a flag in index.html. Let's search in the files it uses.<br />
                We find the flag in style.css.
            </p>
            <div>
                Flag: <code>{"picoCTF{1nsp3ti0n_0f_w3bpag3s_(hash)}"}</code>
            </div>
        </Challenge>

        <Challenge title="Forbidden Paths">
            <code>
                Can you get the flag?<br />
                Here's the website(website link).<br />
                We know that the website files live in /usr/share/nginx/html/ and the flag is at /flag.txt but the website is filtering absolute file paths. Can you get past the filter to read the flag?
            </code>
            <p className="mt-2" >
                We can use ../ to go back a level.<br />
                ../../../../flag.txt
            </p>
            <div>
                Flag: <code>{"picoCTF{7h3_p47h_70_5ucc355_(hash)}"}</code>
            </div>
        </Challenge>

        <Challenge title="Power Cookie" >
            <code>
                Can you get the flag?<br />
                Go to this website and see what you can discover.<br />
                (Hint 1): Do you know how to modify cookies?
            </code>
            <p className="mt-2 text-center" >
                We first login as a guest.<br />
                Then, we can open up DevTools, go to Application, and change cookies.<br />
                isAdmin is 0, we set it to 1.
            </p>
            <div>
                Flag: <code>{"picoCTF{gr4d3_A_c00k13_(hash)}"}</code>
            </div>
        </Challenge>

        <Challenge title="Too lazy to add all of them" >
            <code>
                im literally filling this in 6 months after the ctf cuz im bored, but now im bored of this so im not doing more
            </code>
        </Challenge>
    </div>
}

function Challenge({ title, children }: { title: string, children: React.ReactNode }) {
    return (
        <div className="mt-4 p-2 d-flex flex-column align-items-center" >
            <div>
                <h3>{title}</h3>
            </div>
            {children}
        </div>
    )
}